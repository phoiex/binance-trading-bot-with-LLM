# AI交易监控面板使用说明

## 🎯 功能概述

这是一个实时的AI交易监控网页界面，用于展示你的AI期货交易机器人的状态、收益和决策过程。

**✅ 已修复异步上下文管理器问题，现在运行稳定可靠！**

### ✨ 主要功能

1. **📊 账户概览**
   - 实时显示总资产、未实现盈亏、可用余额
   - 当前持仓数量统计

2. **📍 持仓管理**
   - 展示所有活跃持仓
   - 显示入场价格、当前价格、实时盈亏

3. **💹 市场数据**
   - BTC、ETH、SOL实时价格
   - 24小时涨跌幅和成交量

4. **📈 图表分析**
   - 收益走势折线图
   - 主要币种价格走势图
   - 最近50个数据点历史记录

5. **🤖 AI分析展示**
   - 实时显示AI思考过程
   - 展示最新交易决策
   - 保留最近两次分析结果

## 🚀 快速启动

### 方法一：简化版（推荐）
```bash
# 启动简化版监控面板
./start_simple_dashboard.sh
```

### 方法二：完整版
```bash
# 安装依赖
pip3 install Flask>=2.0.0 Flask-SocketIO>=5.0.0

# 启动完整版监控面板
./start_dashboard.sh
```

## 📱 访问界面

启动成功后，在浏览器中访问：
```
http://localhost:5001
```

### 🖥️ 界面说明

#### 顶部状态栏
- 绿色指示灯：系统正常运行
- 标题显示连接状态

#### 账户概览区域
- **总资产**：账户总价值（USDT）
- **未实现盈亏**：当前持仓的浮动盈亏
- **可用余额**：可用于新交易的资金
- **持仓数量**：活跃持仓的数量

#### 持仓详情表格
| 列名 | 说明 |
|------|------|
| 币种 | 交易对符号 |
| 方向 | 多头/空头 |
| 数量 | 持仓数量 |
| 入场价 | 开仓价格 |
| 当前价 | 实时标记价格 |
| 盈亏 | 未实现盈亏金额 |

#### 市场数据卡片
每个币种显示：
- 当前价格
- 24小时涨跌幅（绿色为涨，红色为跌）

#### 图表区域
- **左侧**：收益走势图，显示未实现盈亏变化
- **右侧**：价格走势图，显示BTC/ETH/SOL价格变化

#### AI分析区域
- **左侧**：AI思考过程，展示分析逻辑
- **右侧**：最新交易决策，包括：
  - 推荐操作（做多/做空/持有）
  - 信心度百分比
  - 入场价格
  - 杠杆倍数
  - 决策理由

## ⚙️ 数据更新机制

### 自动更新
- 数据每**30秒**自动刷新
- 右下角显示最后更新时间
- 图表实时更新最新数据点

### 数据来源

#### 简化版模式
- 使用模拟数据展示功能
- AI内容来自实际的history文件：
  - `history/think.txt` - AI思考过程
  - `history/input.txt` - AI输入数据
  - `history/output.txt` - AI输出结果

#### 完整版模式
- 连接真实的Binance API
- 获取实时账户和市场数据
- 需要有效的API密钥配置

## 📁 文件结构

```
/home/xiaoqibpnm/bitbot/
├── simple_dashboard.py          # 简化版后端
├── web_dashboard.py            # 完整版后端
├── templates/
│   └── dashboard.html          # 前端页面
├── start_simple_dashboard.sh   # 简化版启动脚本
├── start_dashboard.sh          # 完整版启动脚本
├── history/                    # AI历史数据
│   ├── think.txt              # AI思考过程
│   ├── input.txt              # AI输入数据
│   └── output.txt             # AI输出结果
├── history.txt                 # 主要历史记录
└── input-history.txt           # 输入历史记录
```

## 🔧 自定义配置

### 修改更新频率
编辑对应的Python文件，修改这一行：
```python
time.sleep(30)  # 改为其他秒数
```

### 修改端口
编辑启动脚本或Python文件中的：
```python
app.run(host='0.0.0.0', port=5000)  # 改为其他端口
```

### 启用真实数据
在`simple_dashboard.py`中设置：
```python
self.mock_data_enabled = False  # 改为False
```

## 🎨 界面特点

- **响应式设计**：支持桌面和移动设备
- **深蓝色主题**：专业的交易界面风格
- **实时动画**：状态指示灯脉动效果
- **数据可视化**：Chart.js图表库
- **毛玻璃效果**：现代化视觉效果

## 🛠️ 故障排除

### 常见问题

1. **端口占用**
   ```bash
   # 检查端口使用情况
   sudo lsof -i :5000

   # 杀死占用进程
   sudo kill -9 [PID]
   ```

2. **依赖缺失**
   ```bash
   # 手动安装Flask
   pip3 install Flask>=2.0.0
   ```

3. **权限问题**
   ```bash
   # 确保脚本有执行权限
   chmod +x start_simple_dashboard.sh
   ```

4. **历史文件不存在**
   - 启动脚本会自动创建必要的文件和目录
   - 或手动创建：`mkdir -p history && touch history/{think,input,output}.txt`

### 日志查看
程序运行时会在控制台输出日志信息，包括：
- 启动状态
- 数据更新情况
- 错误信息

## 📋 使用建议

1. **首次使用**：建议先用简化版熟悉界面
2. **生产环境**：配置真实API后使用完整版
3. **移动查看**：界面已优化，可在手机上查看
4. **数据备份**：重要的AI分析结果会保存在history文件中

## 🔄 更新和维护

- 重启服务：按Ctrl+C停止，然后重新运行启动脚本
- 清理历史：删除history目录下的文件可清空历史记录
- 升级界面：修改templates/dashboard.html文件